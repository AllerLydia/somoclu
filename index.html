<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Somoclu by peterwittek</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Somoclu</h1>
          <h2>Self-organizing maps on a cluster</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/peterwittek/somoclu/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/peterwittek/somoclu/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/peterwittek/somoclu" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="somoclu" class="anchor" href="#somoclu"><span class="octicon octicon-link"></span></a>Somoclu</h1>

<p>Somoclu is a cluster-oriented implementation of self-organizing maps. It relies on MPI for distributing the workload, and it can be accelerated by CUDA on a GPU cluster. A sparse kernel is also included, which is useful for training maps on vector spaces generated in text mining processes.  The topology of the grid is rectangular.</p>

<p>Key features:</p>

<ul>
<li>Fast execution by parallelization: OpenMP, MPI, and CUDA are supported.</li>
<li>Planar and toroid maps.</li>
<li>Both dense and sparse input data are supported.</li>
<li>Large maps of several hundred thousand neurons are feasible.</li>
<li>Integration with Databionic ESOM Tools.</li>
<li>Python, R, and MATLAB interfaces for the dense CPU kernel.</li>
</ul><p>For more information, refer to the following paper:</p>

<p>Peter Wittek (2013). Somoclu: An Efficient Distributed Library for Self-Organizing Maps. <a href="http://arxiv.org/abs/1305.1422">arXiv:1305.1422</a>.</p>

<h1>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h1>

<p>Somoclu takes a plain text input file -- either dense or sparse data. Example files are included.</p>

<pre><code>$ [mpirun -np NPROC] somoclu [OPTIONs] INPUT_FILE OUTPUT_PREFIX
</code></pre>

<p>Arguments:</p>

<pre><code>-c FILENAME              Specify an initial codebook for the map.
-e NUMBER                Maximum number of epochs
-k NUMBER                Kernel type
                            0: Dense CPU
                            1: Dense GPU
                            2: Sparse CPU
-m TYPE                  Map type: planar or toroid (default: planar)
-t STRATEGY              Radius cooling strategy: linear or exponential (default: linear)
-r NUMBER                Start radius (default: half of the map in direction min(x,y))
-R NUMBER                End radius (default: 1)
-T STRATEGY              Learning rate cooling strategy: linear or exponential (default: linear)
-l NUMBER                Starting learning rate (default: 1.0)
-L NUMBER                Finishing learning rate (default: 0.01)
-s NUMBER                Save interim files (default: 0):
                            0: Do not save interim files
                            1: Save U-matrix only
                            2: Also save codebook and best matching
-x, --columns NUMBER     Number of columns in map (size of SOM in direction x)
-y, --rows    NUMBER     Number of rows in map (size of SOM in direction y)
</code></pre>

<p>Examples:</p>

<pre><code>$ somoclu data/rgbs.txt data/rgbs
$ mpirun -np 4 somoclu -k 0 --rows 20 --columns 20 data/rgbs.txt data/rgbs
</code></pre>

<h1>
<a name="input-file-formats" class="anchor" href="#input-file-formats"><span class="octicon octicon-link"></span></a>Input File Formats</h1>

<p>One sparse and two dense data formats are supported. All of them are plain text files. The entries can be separated by any white-space character. One row represents one data instance across all formats. Comment lines starting with a hash mark are ignored.</p>

<p>The sparse format follows the <a href="http://www.csie.ntu.edu.tw/%7Ecjlin/libsvm/">libsvm</a> guidelines. The first feature is zero-indexed. For instance, the vector [ 1.2 0 0 3.4] is represented as the following line in the file:
0:1.2 3:3.4. The file is parsed twice: once to get the number of instances and features, and the second time to read the data in the individual threads.</p>

<p>The basic dense format includes the coordinates of the data vectors, separated by a white-space. Just like the sparse format, this file is parsed twice to get the basic dimensions right. </p>

<p>The .lrn file of <a href="http://databionic-esom.sourceforge.net/">Databionic ESOM Tools</a> is also accepted and it is parsed only once. The format is described as follows:</p>

<p>% n</p>

<p>% m</p>

<p>% s1        s2          ..      sm</p>

<p>% var_name1 var_name2       ..      var_namem   </p>

<p>x11     x12         ..      x1m</p>

<p>x21     x22         ..      x2m</p>

<p>.       .           .       .</p>

<p>.       .           .       .</p>

<p>xn1     xn2         ..      xnm</p>

<p>Here n is the number of rows in the file, that is, the number of data instances. Parameter m defines the number of columns in the file. The next row defines the column mask: the value 1 for a column means the column should be used in the training. Note that the first column in this format is always a unique key, so this should have the value 9 in the column mask. The row with the variable names is ignore by Somoclu. The elements of the matrix follow -- from here, the file is identical to the basic dense format, with the addition of the first column as the unique key.</p>

<p>If the input file is sparse, but a dense kernel is invoked, Somoclu will execute and results will be incorrect. Invoking a sparse kernel on a dense input file is likely to lead to a segmentation fault.</p>

<h1>
<a name="interfaces" class="anchor" href="#interfaces"><span class="octicon octicon-link"></span></a>Interfaces</h1>

<p>Python, R, and MATLAB interfaces are available for the dense CPU kernel. MPI, CUDA, and the sparse kernel are not support through the interfaces. The connection to the C++ library is seamless, data structures are not duplicated. For respective examples, see the folders in src. All versions require GCC to compile the code.</p>

<p>The Python version is also available in Pypi. You can install it with</p>

<pre><code>$ sudo pip install somoclu
</code></pre>

<p>The R version is available on CRAN. You can install it with</p>

<pre><code>install.packages("Rsomoclu")
</code></pre>

<p>For using the MATLAB toolbox, define the location of the mex compiler in MEX_BIN. Then invoke makeMex.sh in the src/MATLAB folder.</p>

<p>For more information on the respective interfaces, refer to the subfolders in src.</p>

<h1>
<a name="efficient-parallel-execution" class="anchor" href="#efficient-parallel-execution"><span class="octicon octicon-link"></span></a>Efficient Parallel Execution</h1>

<p>The CPU kernels use OpenMP to load multicore processors. On a single node, this is more efficient than launching tasks with MPI to match the number of cores. The MPI tasks replicated the codebook, which is especially inefficient for large maps. </p>

<p>For instance, given a single node with eight cores, the following execution will use 1/8th of the memory, and will run 10-20% faster:</p>

<pre><code>$ somoclu -x 200 -y 200 data/rgbs.txt data/rgbs
</code></pre>

<p>Or, equivalently:</p>

<pre><code>$ OMP_NUM_THREADS=8 somoclu -x 200 -y 200 data/rgbs.txt data/rgbs
</code></pre>

<p>Avoid the following on a single node:</p>

<pre><code>$ OMP_NUM_THREADS=1 mpirun -np 8 somoclu -x 200 -y 200 data/rgbs.txt data/rgbs
</code></pre>

<p>The same caveats apply for the sparse CPU kernel.</p>

<h1>
<a name="visualisation" class="anchor" href="#visualisation"><span class="octicon octicon-link"></span></a>Visualisation</h1>

<p>The primary purpose of generating a map is visualisation. Somoclu does not come with its own functions for visualisation, since there are numerous generic tools that are capable of plotting high-quality figures. </p>

<p>The output formats of the U-matrix and the codebook are compatible with <a href="http://databionic-esom.sourceforge.net/">Databionic ESOM Tools</a> for more advanced visualisation.</p>

<h1>
<a name="dependencies" class="anchor" href="#dependencies"><span class="octicon octicon-link"></span></a>Dependencies</h1>

<p>The only dependency is GCC, although other compiler chains might also work.</p>

<p>Distributed systems and single-machine multicore execution is supported through MPI. The package was tested with OpenMPI, versions 1.3.2 and 1.6.5 were tested. It should also work with other MPI flavours. </p>

<p>CUDA support is optional. CUDA versions 4.1, 5.0 and 5.5 are known to work.</p>

<h1>
<a name="compilation--installation" class="anchor" href="#compilation--installation"><span class="octicon octicon-link"></span></a>Compilation &amp; Installation</h1>

<p>From GIT repository first run</p>

<pre><code>$ ./autogen.sh
</code></pre>

<p>Then follow the standard POSIX procedure:</p>

<pre><code>$ ./configure [options]
$ make
$ make install
</code></pre>

<p>Options for configure</p>

<pre><code>--prefix=PATH           Set directory prefix for installation
</code></pre>

<p>By default Somoclu is installed into /usr/local. If you prefer a
different location, use this option to select an installation
directory.</p>

<pre><code>--without-mpi           Disregard any MPI installation found.
--with-mpi=MPIROOT      Use MPI root directory.
--with-mpi-compilers=DIR or --with-mpi-compilers=yes
                          use MPI compiler (mpicxx) found in directory DIR, or
                          in your PATH if =yes
--with-mpi-libs="LIBS"  MPI libraries [default "-lmpi"]
--with-mpi-incdir=DIR   MPI include directory [default MPIROOT/include]
--with-mpi-libdir=DIR   MPI library directory [default MPIROOT/lib]
</code></pre>

<p>The above flags allow the identification of the correct MPI library the user wishes to use. The flags are especially useful if MPI is installed in a non-standard location, or when multiple MPI libraries are available.</p>

<pre><code>--with-cuda=/path/to/cuda           Set path for CUDA
</code></pre>

<p>Somoclu looks for CUDA in /usr/local/cuda. If your installation is not there, then specify the path with this parameter. If you do not want CUDA enabled, set the parameter to <code>--without-cuda</code>.</p>

<h1>
<a name="acknowledgment" class="anchor" href="#acknowledgment"><span class="octicon octicon-link"></span></a>Acknowledgment</h1>

<p>This work was supported by the European Commission Seventh Framework Programme under Grant Agreement Number FP7-601138 PERICLES and by the AWS in Education Machine Learning Grant award.</p>
        </section>

        <footer>
          Somoclu is maintained by <a href="https://github.com/peterwittek">peterwittek</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>